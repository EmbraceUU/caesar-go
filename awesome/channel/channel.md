# Channel

## 概念

### CSP

Communicating Sequential Process, 通过CSP模式消除了竟态

Channel是显式的, 收发双方需要知道数据结构和通道

只要有一方未准备妥当, 即被阻塞

### 同步模式

收发双方配对成功, 将数据直接复制给对方

未配对成功, 进入等待状态, 准备好后被唤醒

### 异步模式

抢夺数据缓冲区, 有空槽时, 发送方可以写入, 有数据时, 接收方可以读取数据

条件不符合时, 同样进入等待状态, 准备好后被唤醒

**缓冲区大小不属于类型组成部分**

### 判断相等

channel变量是指针, 可以用==判断是否是同一个, 以及判断nil

### 大小

异步模式: 
len()为缓冲区数据大小
cap()为缓冲区大小

同步模式:
len和cap都为0

## 处理方式

### ok-idom

### range

## 选择

### select

## 应用

### 传递消息

### 事件通知

可以通知事件结束

使用close通知可以是群体性的

一次性通知推荐使用close

连续通知使用消息传递, 或者sync.Cond


## 注意

### 一定要close channel, 否则可能会导致goroutine死锁

### 向已关闭通道发送消息, 会panic

### 从已关闭通道读取消息, 会读取缓冲区数据或者零值

### 无论收发, nil都会阻塞

### 重复关闭/关闭nil通道, 会引发panic

### 使用make创建单向通道, 没有意义

### close不能用于接收端, 会引发panic

### 无法将单向通道转换回去